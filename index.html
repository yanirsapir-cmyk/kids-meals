<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>××¨×•×—×•×ª ×”×™×œ×“×™×</title>

  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#2563eb">
  <link rel="apple-touch-icon" href="icon-192.png">

  <style>
    :root{
      --bg:#f6f7fb; --card:#fff; --border:#e5e7eb;
      --primary:#2563eb; --danger:#dc2626; --muted:#6b7280;
      --shadow:0 6px 18px rgba(0,0,0,0.06);
      --radius:14px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; padding:14px;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg); color:#111827;
    }
    h1{margin:6px 0 14px;font-size:24px;font-weight:900}
    h2{margin:0 0 10px;font-size:18px}
    h3{margin:12px 0 6px;font-size:14px;color:var(--muted)}
    .card{
      background:var(--card); border:1px solid var(--border);
      border-radius:var(--radius); box-shadow:var(--shadow);
      padding:14px; margin-bottom:14px;
    }

    .btn{padding:10px 14px;border-radius:10px;border:none;font-weight:800;cursor:pointer}
    .primary{background:var(--primary);color:#fff}
    .danger{background:var(--danger);color:#fff}

    .tabs{display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap}
    .tabbtn{
      border:1px solid var(--border);background:#fff;border-radius:999px;
      padding:9px 12px;font-weight:900;cursor:pointer
    }
    .tabbtn.active{background:var(--primary);color:#fff;border-color:var(--primary)}
    .view{display:none}
    .view.active{display:block}

    /* ===== History / Week rows ===== */
    .mealrow{
      display:flex;
      align-items:center;
      gap:10px;
      border:1px solid var(--border);
      background:#fff;
      border-radius:14px;
      padding:10px;
      margin-bottom:8px;
      flex-wrap:nowrap;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:6px 10px;
      border-radius:999px;
      font-weight:900;
      font-size:13px;
      border:1px solid var(--border);
      white-space:nowrap;
    }
    .datepill{min-width:110px;background:#f3f4f6}
    .typepill{min-width:78px;border:none}

    .type-boker{background:#fff7ed}
    .type-tzohor{background:#ecfeff}
    .type-erev{background:#eef2ff}
    .type-bein{background:#fdf2f8}

    .mealname{
      flex:1;
      font-weight:900;
      min-width:120px;
      white-space:normal;
      overflow:hidden;
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
    }

    .kidstxt{
      min-width:130px;
      max-width:38%;
      font-weight:800;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .delbtn{
      min-width:66px;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#fff;
      font-weight:900;
      cursor:pointer;
      white-space:nowrap;
    }

    /* ===== Filters ===== */
    .filters{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin:8px 0 12px;
    }
    .filter{
      display:flex;
      align-items:center;
      gap:6px;
      font-weight:800;
    }
  </style>
</head>

<body>
<h1>ğŸ½ï¸ ××¨×•×—×•×ª ×”×™×œ×“×™×</h1>

<div class="tabs">
  <button class="tabbtn active" onclick="showTab('data')">× ×ª×•× ×™×</button>
</div>

<section id="view-data" class="view active">

  <section class="card">
    <h2>×”×™×¡×˜×•×¨×™×”</h2>

    <!-- Filters -->
    <div class="filters">
      <label class="filter"><input type="checkbox" value="×‘×•×§×¨" checked onchange="renderAll()"> ×‘×•×§×¨</label>
      <label class="filter"><input type="checkbox" value="×¦×”×¨×™×™×" checked onchange="renderAll()"> ×¦×”×¨×™×™×</label>
      <label class="filter"><input type="checkbox" value="×¢×¨×‘" checked onchange="renderAll()"> ×¢×¨×‘</label>
      <label class="filter"><input type="checkbox" value="×‘×™× ×™×™×" checked onchange="renderAll()"> ×‘×™× ×™×™×</label>
    </div>

    <div id="historyWrap"></div>
  </section>

  <section class="card">
    <h2>×©×‘×•×¢ ××—×¨×•×Ÿ</h2>
    <input type="date" id="weekEndDate" onchange="renderAll()">
    <div id="weekWrap"></div>
  </section>

</section>

<script>
  /* ===== Demo data (×›×“×™ ×©×ª×¨××” ×¢×•×‘×“ ×’× ×× ××™×Ÿ ×›×œ×•×) ===== */
  let meals = JSON.parse(localStorage.getItem("meals")) || [];

  function showTab(){}

  function getActiveTypes(){
    return Array.from(document.querySelectorAll(".filters input:checked"))
      .map(cb => cb.value);
  }

  function typeClass(t){
    if(t==="×‘×•×§×¨") return "type-boker";
    if(t==="×¦×”×¨×™×™×") return "type-tzohor";
    if(t==="×¢×¨×‘") return "type-erev";
    return "type-bein";
  }

  function createRow(m){
    const row = document.createElement("div");
    row.className = "mealrow";
    row.innerHTML = `
      <span class="pill datepill">${m.date}</span>
      <span class="pill typepill ${typeClass(m.type)}">${m.type}</span>
      <div class="mealname">${m.meal || "××¨×•×—×” ××¤×•×¦×œ×ª"}</div>
      <div class="kidstxt">${m.kids || ""}</div>
      <button class="delbtn" onclick="deleteRow('${m.id}')">××—×§</button>
    `;
    return row;
  }

  function deleteRow(id){
    meals = meals.filter(m => m.id !== id);
    localStorage.setItem("meals", JSON.stringify(meals));
    renderAll();
  }

  function renderAll(){
    const types = getActiveTypes();

    const history = document.getElementById("historyWrap");
    history.innerHTML = "";

    meals
      .filter(m => types.includes(m.type))
      .sort((a,b)=>b.date.localeCompare(a.date))
      .forEach(m => history.appendChild(createRow(m)));

    const end = document.getElementById("weekEndDate").value;
    if(!end) return;

    const start = new Date(end);
    start.setDate(start.getDate()-6);
    const week = document.getElementById("weekWrap");
    week.innerHTML = "";

    meals
      .filter(m => types.includes(m.type))
      .filter(m => m.date >= start.toISOString().slice(0,10) && m.date <= end)
      .sort((a,b)=>b.date.localeCompare(a.date))
      .forEach(m => week.appendChild(createRow(m)));
  }

  const today = new Date().toISOString().slice(0,10);
  document.getElementById("weekEndDate").value = today;
  renderAll();
</script>

</body>
</html>
