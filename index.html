<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ארוחות הילדים</title>
</head>
<body>

<h1>ארוחות הילדים</h1>

<section>
  <h2>רישום ארוחה</h2>

  <label>
    תאריך:
    <input type="date" id="dateInput">
  </label>
  <br><br>

  <label>
    סוג ארוחה:
    <select id="mealType">
      <option value="בוקר">בוקר</option>
      <option value="צהריים">צהריים</option>
      <option value="ערב">ערב</option>
      <option value="ביניים">ביניים</option>
    </select>
  </label>
  <br><br>

  <label>
    מנה:
    <select id="mealSelect"></select>
  </label>
  <br><br>

  <label>
    הוסף מנה חדשה:
    <input type="text" id="newMealInput" placeholder="לדוגמה: פסטה">
    <button onclick="addMeal()">הוסף</button>
  </label>
  <br><br>

  <strong>מי אכל?</strong><br>
  <label><input type="checkbox" id="mika"> מיקה</label><br>
  <label><input type="checkbox" id="omer"> עומר</label><br><br>

  <button onclick="saveMeal()">שמירה</button>
</section>

<hr>

<section>
  <h2>מה אכלו היום</h2>
  <ul id="mealList"></ul>
</section>

<script>
  let meals = JSON.parse(localStorage.getItem("meals")) || [];
  let mealOptions = JSON.parse(localStorage.getItem("mealOptions")) || [];

  function saveData() {
    localStorage.setItem("meals", JSON.stringify(meals));
    localStorage.setItem("mealOptions", JSON.stringify(mealOptions));
  }

  function addMeal() {
    const input = document.getElementById("newMealInput");
    const value = input.value.trim();
    if (!value) return;

    if (!mealOptions.includes(value)) {
      mealOptions.push(value);
      saveData();
      renderMealOptions();
    }
    input.value = "";
  }

  function renderMealOptions() {
    const select = document.getElementById("mealSelect");
    select.innerHTML = "";
    mealOptions.forEach(m => {
      const opt = document.createElement("option");
      opt.value = m;
      opt.textContent = m;
      select.appendChild(opt);
    });
  }

  function saveMeal() {
    const date = document.getElementById("dateInput").value;
    const type = document.getElementById("mealType").value;
    const meal = document.getElementById("mealSelect").value;
    const kids = [];

    if (document.getElementById("mika").checked) kids.push("מיקה");
    if (document.getElementById("omer").checked) kids.push("עומר");

    if (!date || !meal || kids.length === 0) {
      alert("נא למלא תאריך, לבחור מנה ולבחור לפחות ילד אחד");
      return;
    }

    meals.push({ date, type, meal, kids });
    saveData();
    renderMeals();
  }

  function renderMeals() {
    const list = document.getElementById("mealList");
    list.innerHTML = "";
    meals.forEach(m => {
      const li = document.createElement("li");
      li.textContent = `${m.date} | ${m.type} | ${m.meal} | ${m.kids.join(", ")}`;
      list.appendChild(li);
    });
  }

  renderMealOptions();
  renderMeals();
</script>

</body>
</html>
